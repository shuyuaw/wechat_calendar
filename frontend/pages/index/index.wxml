<view class="container page-container-safe-index">
  <view class="header-actions">
    <view class="page-title">可预约时段</view>
    <button size="mini" class="my-bookings-button" bindtap="goToMyBookings">我的预约</button>
  </view>

  <view wx:if="{{isLoading}}" class="loading-message">
    <text>正在加载...</text>
  </view>

  <view wx:if="{{!isLoading && error}}" class="error-message">
    <text>加载失败: {{error}}</text>
    <button size="mini" bindtap="fetchAvailableSlots">重试</button>
  </view>

  <view wx:if="{{!isLoading && !error && groupedSlots.length === 0}}" class="no-slots-message">
    <text>本周当前没有可预约时段。</text>
  </view>

  <block wx:if="{{!isLoading && !error && groupedSlots.length > 0}}">
    <view wx:for="{{groupedSlots}}" wx:for-item="group" wx:key="date" class="date-group">
      <view class="date-header">{{group.date}}</view>
      <view class="slot-list">
        <view
          wx:for="{{group.slots}}"
          wx:key="slotId"
          class="slot-item"
          bindtap="handleBookSlot"
          data-slot-id="{{item.slotId}}"
          data-start-time="{{item.startTime}}"
        >
          <view class="slot-datetime-details">
            <text class="slot-time">{{item.displayTime}}</text>
          </view>
          <text class="book-indicator">预约</text>
        </view>
      </view>
    </view>
  </block>

</view>
